---
id: configure-initialize-supertokens
title: Configure and Initialize SuperTokens
hide_title: false
show_ui_switcher: false
---

<!-- COPY SECTION -->
<!-- ./thirdpartyemailpassword/remix/configure-initialize-supertokens.mdx -->
<!-- 1 -->

import AppInfoForm from "/src/components/appInfoForm";

To initialize SuperTokens, you must pass configuration settings to the SuperTokens initialization function. After creating the configuration files, we'll add the function call to initialize SuperTokens using the frontend and backend configuration settings.

## Install the SuperTokens Packages

Install the following SuperTokens packages, as shown below:

```bash
npm install supertokens-node supertokens-auth-react
```

## Create the Configuration Files

Create a `config` folder within your project's `app` directory. This folder will contain the SuperTokens configuration files for your Remix project. Inside this folder, create three configuration files:

- Create an `appInfo.tsx` file inside the `config` folder.
- Create a `backendConfig.tsx` file inside the `config` folder.
- Create a `frontendConfig.tsx` file inside the `config` folder.

:::tip
At this stage, your `app` folder should now resemble the following:

ðŸ“¦app
â”£ ðŸ“‚config
â”ƒ â”£ ðŸ“œappInfo.tsx
â”ƒ â”£ ðŸ“œbackend.tsx
â”ƒ â”— ðŸ“œfrontend.tsx

:::

## Add the Application Configuration

Enter and submit your application information in the form below to update the code sample:

<AppInfoForm
  askForAppName
  askForAPIDomain
  askForWebsiteDomain
>

```tsx title="app/config/appInfo.tsx"
export const appInfo = {
  appName: "^{form_appName}",
  apiDomain: "^{form_apiDomain}",
  websiteDomain: "^{form_websiteDomain}",
  apiBasePath: "^{form_apiBasePath}",
  websiteBasePath: "^{form_websiteBasePath}",
};
```

Copy the code sample and paste it into `appInfo.tsx`. The generated code sample contains general information about your application required by SuperTokens.

## Add the Frontend Configuration Function

Add the following code to `frontend.tsx`:

<!-- END COPY SECTION -->

```tsx title="app/config/frontend.tsx"
import EmailPassword from "supertokens-auth-react/recipe/emailpassword/index.js";
import Session from "supertokens-auth-react/recipe/session/index.js";
// @ts-ignore
import { appInfo } from "./appInfo";
import { SuperTokensConfig } from "supertokens-auth-react/lib/build/types";
import EmailVerification from "supertokens-auth-react/recipe/emailverification/index.js";

export const frontendConfig = (): SuperTokensConfig => {
  return {
    appInfo,
    recipeList: [
      EmailPassword.init(),
      EmailVerification.init(),
      Session.init(),
    ],
  };
};
```

<!-- COPY SECTION -->
<!-- ./thirdpartyemailpassword/remix/configure-initialize-supertokens.mdx -->
<!-- 2 -->

The `frontendConfig()` function returns a configuration object (`SuperTokensConfig`) containing the information necessary for initializing SuperTokens on the frontend.

## Add the Backend Configuration

Add the following code to `backendConfig.tsx`:

<!-- END COPY SECTION -->

```tsx title="/config/backendConfig.tsx"
import EmailPassword from "supertokens-node/recipe/emailpassword/index.js";
import SessionNode from "supertokens-node/recipe/session/index.js";
import Dashboard from "supertokens-node/recipe/dashboard/index.js";
import UserRoles from "supertokens-node/recipe/userroles/index.js";
import type { TypeInput } from "supertokens-node/types";
import SuperTokens from "supertokens-node";
// @ts-ignore
import { appInfo } from "./appInfo";
import EmailVerification from "supertokens-node/recipe/emailverification/index.js";

export const backendConfig = (): TypeInput => {
  return {
    supertokens: {
      // this is the location of the SuperTokens core.
      connectionURI: "https://try.supertokens.com",
    },
    appInfo: appInfo,
    recipeList: [
      EmailPassword.init(),
      EmailVerification.init({
        mode: "REQUIRED",
      }),
      SessionNode.init(),
      Dashboard.init(),
      UserRoles.init(),
    ],
    isInServerlessEnv: true,
    framework: "custom",
  };
};

let initialized = false;
export function ensureSuperTokensInit() {
  if (!initialized) {
    SuperTokens.init(backendConfig());
    initialized = true;
  }
}
```

<!-- COPY SECTION -->
<!-- ./thirdpartyemailpassword/remix/configure-initialize-supertokens.mdx -->
<!-- 3 -->

It contains two functions, `backendConfig()` and `ensureSuperTokensInit()`:

- `backendConfig()` provides your application's configuration settings for SuperTokens and other backend-related features.
- `ensureSuperTokensInit()` ensures SuperTokens is initialized only once in the Remix server-side code.

Here's how it works:

1. The `ensureSuperTokensInit()` function first checks if SuperTokens has been initialized. If it is, it doesn't need to perform the initialization process again (skip steps #2 and #3).
2. If it has not, it initializes SuperTokens by calling `SuperTokens.init()` with the provided configuration obtained from the `backendConfig()` function.
3. After initialization, it sets the initialized flag to `true` to indicate that SuperTokens has been initialized.

### Update the SuperTokens Core URI

The provided `connectionURI`, `https://try.supertokens.com`, should only be used for testing purposes. After completing the SuperTokens integration, you'll need to set up an instance of the SuperTokens core for your app. Refer to [Next Steps](./next-steps.mdx) for options.

### Add Your Own Client IDs and Secrets

The provided client IDs and secrets should be used for testing purposes only. After completing the SuperTokens integration, generate client IDs and client secrets for each desired provider:

<details>
<summary>Google</summary>

- Generate your `clientId` and `clientSecret` by following the [docs here](https://support.google.com/cloud/answer/6158849?hl=en).
- Set the authorisation callback URL to `^{form_websiteDomain}^{form_websiteBasePathForCallbacks}/callback/google`.

</details>

<details>
<summary>Github</summary>

- Generate your `clientId` and `clientSecret` by following the [docs here](https://docs.github.com/en/developers/apps/creating-an-oauth-app).
- Set the authorisation callback URL to `^{form_websiteDomain}^{form_websiteBasePathForCallbacks}/callback/github`.

</details>

<details>
<summary>Facebook</summary>

- Generate your `clientId` and `clientSecret` by following the [docs here](https://developers.facebook.com/docs/development/create-an-app).
- Set the authorisation callback URL to `^{form_websiteDomain}^{form_websiteBasePathForCallbacks}/callback/facebook`.

:::info Note
Make sure to enable `https` to use the test users of the Facebook app. On `http://localhost`, only the admin user can verify the login flow.
:::

</details>

<details>
<summary>Apple</summary>

- Generate your `clientId` and `clientSecret` by following [this article](https://medium.com/identity-beyond-borders/how-to-configure-sign-in-with-apple-77c61e336003).
- Set the authorisation callback URL to `^{form_apiDomain}^{form_apiBasePathForCallbacks}/callback/apple`. Note that Apple doesn't allow `localhost` in the URL. If you are in dev mode, you can use the dev keys we have provided above.

</details>

</AppInfoForm>

## Initialize SuperTokens on the Backend

We'll now add a function call in the `entry.server.tsx` to initialize SuperTokens on the backend.

:::info
`entry.server.tsx` is the server-side rendering (SSR) entry point in a Remix project in the `app` folder. If this file is not visible, run `npx remix reveal`. A `entry.frontend.tsx` file is not required for integrating SuperTokens.
:::

Import the `ensureSuperTokensInit()` function and add a function call to it:

```tsx title="app/entry.server.tsx"
// @ts-ignore
import { ensureSuperTokensInit } from "~/config/backend";

// Other default or user-defined settings

ensureSuperTokensInit();
```

<!-- END COPY SECTION -->
