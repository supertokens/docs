---
id: reset-password-flow
title: Building the reset password flow
hide_title: true
---

<!-- COPY DOCS -->
<!-- ./thirdpartyemailpassword/common-customizations/reset-password/reset-password-flow.mdx -->

import PreBuiltUITabs from "/src/components/tabs/PreBuiltUITabs";
import {PreBuiltOrCustomUISwitcher, PreBuiltUIContent, CustomUIContent} from "/src/components/preBuiltOrCustomUISwitcher"
import TabItem from "@theme/TabItem";
import CustomUITabs, { FrontendMobileSubTabs, FrontendWebSubTabs } from "/src/components/tabs/CustomUITabs";

# Building the reset password flow

<PreBuiltOrCustomUISwitcher>

<PreBuiltUIContent>

<PreBuiltUITabs>

<TabItem value="reactjs">

You will see this if you navigate to `/auth/reset-password`. Note: this may be visible on a different route if you have configured a different value for `websiteBasePath`.
 
<img alt="UI to send password reset email" width="500px" src="/img/emailpassword/reset-password-enter-email.png" />

When the user submits their information, the SDK will call the [`/user/password/reset/token`](https://supertokens.com/docs/fdi#/ThirdPartyEmailPassword%20Recipe/thirdPartyEmailPasswordPasswordResetToken) API which will generate a new token and send an email to the user.

:::info
You can view a sample of the email sent to the user [here](../../common-customizations/reset-password/password-reset-email.mdx). Note this email is only sent if a user with the provided email exists.
:::

When the user clicks on the link in the email they will be taken to the `/auth/reset-password?token=TOKEN` page. The SDK presents a form that allows the users to change their password:

<img alt="UI to change password" width="500px" src="/img/emailpassword/reset-password-submit-new-password.png" />

The SDK calls the [`/user/password/reset`](https://supertokens.com/docs/fdi#/ThirdPartyEmailPassword%20Recipe/thirdPartyEmailPasswordPasswordReset) API which sets a new password for the user

</TabItem>

</PreBuiltUITabs>

</PreBuiltUIContent>

<CustomUIContent>

## Sending the reset password email

<CustomUITabs>

<TabItem value="web">

<FrontendWebSubTabs>

<TabItem value="npm">

After you prompt for the user's email you can call the `sendPasswordResetEmail` function, if the a user with the provided email exists they will receive an email with a link to reset their password.

```tsx
import ^{recipeNameCapitalLetters} from "supertokens-web-js/recipe/^{codeImportRecipeName}"

async function sendResetEmail(email: string) {
    const response = await ^{recipeNameCapitalLetters}.sendPasswordResetEmail({
        formFields: [
            {
                id: "email",
                value: email,
            }
        ],
    });

    // Error handling
    if (response.status === "FIELD_ERROR") {
        // Iterate through form fields to identify the error
        response.formFields.forEach(field => {
            // The id will match the values you passed when calling signUp
            console.log("Error in field with id:", field.id)
            console.log(field.error);
        })
    }
}
```

</TabItem>

<TabItem value="script">

After you prompt for the user's email you can call the `sendPasswordResetEmail` function, if the a user with the provided email exists they will receive an email with a link to reset their password.

```tsx
import ^{recipeNameBundle} from "supertokens-web-js-script/recipe/^{codeImportRecipeName}"
async function sendResetEmail(email: string) {
    const response = await ^{recipeNameBundle}.sendPasswordResetEmail({
        formFields: [
            {
                id: "email",
                value: email,
            }
        ],
    });

    if (response.status === "FIELD_ERROR") {
        // Iterate through form fields to identify the error
        response.formFields.forEach(field => {
            // The id will match the values you passed when calling signUp
            console.log("Error in field with id:", field.id)
            console.log(field.error);
        })
    }
}
```

</TabItem>

</FrontendWebSubTabs>

:::danger
The `sendPasswordResetEmail` function will return `{"status": "OK"}` even if the provided email is not associated with a user, however it will not send an email in this case
:::

</TabItem>
<TabItem value="mobile">

<FrontendMobileSubTabs>

</FrontendMobileSubTabs>

</TabItem>

</CustomUITabs>

## Set a new password for a user

:::info
By default the the email will link to `/auth/reset-password?token=`. When using custom UI, you have to handle this route in your frontend application. You can change the base path used in the email by setting a different value for `websiteBasePath` on your backend when [calling the init function](../../quick-setup/backend#2-initialise-supertokens)
:::

<CustomUITabs>

<TabItem value="web">

<FrontendWebSubTabs>

<TabItem value="npm">

Once the user clicks on the link in the email, you can prompt the user to enter a new password and then call the `submitNewPassword` function.

```tsx
import ^{recipeNameCapitalLetters} from "supertokens-web-js/recipe/^{codeImportRecipeName}";

async function submitNewPassword(password: string) {
    const response = await ^{recipeNameCapitalLetters}.submitNewPassword({
        formFields: [
            {
                id: "password",
                value: password,
            }
        ],
    });

    if (response.status === "RESET_PASSWORD_INVALID_TOKEN_ERROR") {
        // Token in the query params of the current location is either invalid or expired
    }

    if (response.status === "FIELD_ERROR") {
        // Iterate through form fields to identify the error
        response.formFields.forEach(field => {
            // The id will match the values you passed when calling signUp
            console.log("Error in field with id:", field.id)
            console.log(field.error);
        })
    }
}
```

</TabItem>

<TabItem value="script">

Once the user clicks on the link in the email, you can prompt the user to enter a new password and then call the `submitNewPassword` function.

```tsx
import ^{recipeNameBundle} from "supertokens-web-js-script/recipe/^{codeImportRecipeName}";

async function submitNewPassword(password: string) {
    const response = await ^{recipeNameBundle}.submitNewPassword({
        formFields: [
            {
                id: "password",
                value: password,
            }
        ],
    });

    if (response.status === "RESET_PASSWORD_INVALID_TOKEN_ERROR") {
        // Token in the query params of the current location is either invalid or expired
    }

    if (response.status === "FIELD_ERROR") {
        // Iterate through form fields to identify the error
        response.formFields.forEach(field => {
            // The id will match the values you passed when calling signUp
            console.log("Error in field with id:", field.id)
            console.log(field.error);
        })
    }
}
```

</TabItem>

</FrontendWebSubTabs>

</TabItem>
<TabItem value="mobile">

<FrontendMobileSubTabs>

</FrontendMobileSubTabs>

</TabItem>

</CustomUITabs>

</CustomUIContent>

</PreBuiltOrCustomUISwitcher>